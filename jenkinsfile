node {



    stage('Clone sources') {
       git branch: 'main', credentialsId: 'admin_git_creds', url: 'https://github.com/sudir/yaml_deployer.git'
    }

    stage('Artifactory configuration') {

        withAWS(credentials: 'aws-admin-credentials', region: 'us-east-1') {
            // Do some aws action to test API plugin
            aws get sts-caller-identity
    }
     
    }

    stage('OS Check') {
       whoami
    }

    stage('Publish build info') {
        server.publishBuildInfo buildInfo
    }
}
